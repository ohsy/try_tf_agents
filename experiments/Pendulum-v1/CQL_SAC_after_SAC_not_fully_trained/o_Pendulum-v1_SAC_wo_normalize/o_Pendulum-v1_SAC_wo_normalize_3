2025-01-25 13:17:03.613099: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-01-25 13:17:03.613151: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-01-25 13:17:03.614071: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-01-25 13:17:03.620687: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-01-25 13:17:04.553432: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
online arguments=['play.py', '-e', 'Pendulum-v1', '-a', 'SAC_wo_normalize', '-c', './result/Pendulum-v1_CQL_SAC_0125_123106/model']
2025-01-25 13:17:06.865166: E external/local_xla/xla/stream_executor/cuda/cuda_driver.cc:274] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2025-01-25 13:17:06.865218: I external/local_xla/xla/stream_executor/cuda/cuda_diagnostics.cc:129] retrieving CUDA diagnostic information for host: sohubuntuserver
2025-01-25 13:17:06.865226: I external/local_xla/xla/stream_executor/cuda/cuda_diagnostics.cc:136] hostname: sohubuntuserver
2025-01-25 13:17:06.865421: I external/local_xla/xla/stream_executor/cuda/cuda_diagnostics.cc:159] libcuda reported version is: 555.42.2
2025-01-25 13:17:06.865456: I external/local_xla/xla/stream_executor/cuda/cuda_diagnostics.cc:163] kernel reported version is: 555.42.2
2025-01-25 13:17:06.865464: I external/local_xla/xla/stream_executor/cuda/cuda_diagnostics.cc:241] kernel version seems to match DSO: 555.42.2
2025-01-25 13:17:06,892 - INFO - config={'dtype': 'float32', 'intdtype': 'int32', 'resultPath': './result', 'isGpuUsed': False, 'log_level_name': 'INFO', '# log_level_name': 'like INFO or DEBUG', 'isSummaryWriterUsed': False, 'environment': 'CartPole-v0', 'environment_wrapper': None, 'agent': 'DQN', 'replay_buffer': 'tf_uniform', 'isPerUsed': False, 'driver': 'dynamic_step', 'num_actions': 3, '# num_actions discretized: for ActionDiscretizeWrapper': None, 'num_time_steps': 1000, '# num_time_steps': '0 for sys.maxsize', 'num_time_steps_to_collect': 1, 'num_time_steps_to_train': 1, 'num_time_steps_to_log': 10, 'num_time_steps_to_eval': 100, 'num_train_steps_to_save': 10000, '# num_logs': 500, '# num_evals': 50, '# for CDQN': None, 'num_atoms': 51, 'min_q_value': -20, 'max_q_value': 20, 'n_step_update': 1, 'qnet_fc_layer_params': [128, 64], 'actor_fc_layer_params': [256, 256], 'critic_observation_fc_layer_params': None, '# critic_observation_fc_layer_params': '[32, 32] for Pendulum', 'critic_action_fc_layer_params': None, '# critic_action_fc_layer_params': '[32, 32] for Pendulum', 'critic_joint_fc_layer_params': [256, 256], '# actor_fc_layer_params': '[32, 32] for Pendulum', '# critic_joint_fc_layer_params': '[128, 16] for Pendulum', 'batch_size': 64, 'learning_rate': 0.001, '# learning_rate default': 0.001, 'actor_learning_rate': 0.0003, 'critic_learning_rate': 0.0006, 'alpha_learning_rate': 0.0003, 'target_update_tau': 0.005, 'target_update_period': 1, 'gamma': 0.99, 'reward_scale_factor': 1.0, 'epsilon_greedy': 0.1, 'replay_buffer_max_length': 15000, '# num_frames = capacity = max_length * env.batch_size and default env.batch_size = 1': None, 'num_env_steps_to_collect_init': 5000, 'num_env_steps_to_collect_per_time_step': 1, 'num_episodes_to_collect_init': 10, 'num_episodes_to_collect_per_time_step': 1, 'checkpoint_max_to_keep': 2, '# for PPO': None, 'num_episodes_to_eval': 10, 'value_fc_layer_params': [256, 256], 'num_parallel_envs': 30, 'num_env_steps': 20000, 'num_collect_episodes_per_train_step': 30, '# also for BC, CQL_SAC': None, 'num_epochs': 25, 'reverb_port': 8008, '#  ending': None}
2025-01-25 13:17:06,892 - INFO - args=Namespace(environment='Pendulum-v1', environment_wrapper=None, agent='SAC_wo_normalize', replay_buffer=None, driver=None, checkpoint_path='./result/Pendulum-v1_CQL_SAC_0125_123106/model', fill_after_restore=None, reverb_checkpoint_path=None, num_actions=None, num_env_steps_to_collect_init=None, epsilon_greedy=None, reverb_port=None)
2025-01-25 13:17:06,892 - INFO - environment=Pendulum-v1
2025-01-25 13:17:06,892 - INFO - envWrapper=None
2025-01-25 13:17:06,892 - INFO - agent=SAC_wo_normalize
2025-01-25 13:17:06,892 - INFO - replay_buffer=tf_uniform
2025-01-25 13:17:06,893 - INFO - driver=dynamic_step
2025-01-25 13:17:06,893 - INFO - num_env_steps_to_collect_init=5000
2025-01-25 13:17:06,893 - INFO - epsilon_greedy=0.1
2025-01-25 13:17:06,893 - INFO - checkpointPath_toRestore=./result/Pendulum-v1_CQL_SAC_0125_123106/model
2025-01-25 13:17:06,893 - INFO - checkpointPath_toSave=./result/Pendulum-v1_SAC_wo_normalize_0125_131706/model
2025-01-25 13:17:06,893 - INFO - reverb_port=8008
2025-01-25 13:17:06,994 - INFO - tf_observation_spec: BoundedTensorSpec(shape=(3,), dtype=tf.float32, name='observation', minimum=array([-1., -1., -8.], dtype=float32), maximum=array([1., 1., 8.], dtype=float32))
2025-01-25 13:17:06,995 - INFO - tf_action_spec: BoundedTensorSpec(shape=(1,), dtype=tf.float32, name='action', minimum=array(-2., dtype=float32), maximum=array(2., dtype=float32))
2025-01-25 13:17:06,996 - INFO - tf_env_step_spec: TimeStep(
{'step_type': TensorSpec(shape=(), dtype=tf.int32, name='step_type'),
 'reward': TensorSpec(shape=(), dtype=tf.float32, name='reward'),
 'discount': BoundedTensorSpec(shape=(), dtype=tf.float32, name='discount', minimum=array(0., dtype=float32), maximum=array(1., dtype=float32)),
 'observation': BoundedTensorSpec(shape=(3,), dtype=tf.float32, name='observation', minimum=array([-1., -1., -8.], dtype=float32), maximum=array([1., 1., 8.], dtype=float32))})
2025-01-25 13:17:06,996 - INFO - min_q_value=-1500, max_q_value=0
2025-01-25 13:17:07,235 - INFO - tf_agent_collect_data_spec: Trajectory(
{'step_type': TensorSpec(shape=(), dtype=tf.int32, name='step_type'),
 'observation': BoundedTensorSpec(shape=(3,), dtype=tf.float32, name='observation', minimum=array([-1., -1., -8.], dtype=float32), maximum=array([1., 1., 8.], dtype=float32)),
 'action': BoundedTensorSpec(shape=(1,), dtype=tf.float32, name='action', minimum=array(-2., dtype=float32), maximum=array(2., dtype=float32)),
 'policy_info': (),
 'next_step_type': TensorSpec(shape=(), dtype=tf.int32, name='step_type'),
 'reward': TensorSpec(shape=(), dtype=tf.float32, name='reward'),
 'discount': BoundedTensorSpec(shape=(), dtype=tf.float32, name='discount', minimum=array(0., dtype=float32), maximum=array(1., dtype=float32))})
WARNING:tensorflow:From /home/soh/tf_venv/lib/python3.10/site-packages/tensorflow/python/autograph/impl/api.py:377: ReplayBuffer.get_next (from tf_agents.replay_buffers.replay_buffer) is deprecated and will be removed in a future version.
Instructions for updating:
Use `as_dataset(..., single_deterministic_pass=False) instead.
2025-01-25 13:17:07,418 - WARNING - From /home/soh/tf_venv/lib/python3.10/site-packages/tensorflow/python/autograph/impl/api.py:377: ReplayBuffer.get_next (from tf_agents.replay_buffers.replay_buffer) is deprecated and will be removed in a future version.
Instructions for updating:
Use `as_dataset(..., single_deterministic_pass=False) instead.
2025-01-25 13:17:08,327 - INFO - ending get_replay_buffer(), replay_buffer.num_frames()=0
2025-01-25 13:17:08,328 - INFO - No checkpoint available at ./result/Pendulum-v1_SAC_wo_normalize_0125_131706/model
2025-01-25 13:17:13,446 - INFO - random_policy avg_return=-1001.653
2025-01-25 13:17:13,446 - INFO - replay_buffer.capacity=15000
2025-01-25 13:17:13,447 - INFO - before restoring with checkpointer, replay_buffer.num_frames()=0
2025-01-25 13:17:13,447 - INFO - restoring from checkpointPath_toRestore=./result/Pendulum-v1_CQL_SAC_0125_123106/model
2025-01-25 13:17:13,447 - INFO - restoring agent and replay_buffer
2025-01-25 13:17:13,448 - INFO - Checkpoint available: ./result/Pendulum-v1_CQL_SAC_0125_123106/model/ckpt-10000
2025-01-25 13:17:13,548 - INFO - after restoring with checkpointer, replay_buffer.num_frames()=15000
2025-01-25 13:17:13,548 - INFO - restoring time = 0.102
2025-01-25 13:18:27,508 - INFO - before training, avg_return=-120.870
2025-01-25 13:18:29,635 - INFO - time_step=0 loss=361.349 time=2.126
2025-01-25 13:19:40,537 - INFO - time_step=0 avg_return=-146.429
2025-01-25 13:19:40,982 - INFO - time_step=10 loss=116.564 time=71.347
2025-01-25 13:19:41,415 - INFO - time_step=20 loss=120.452 time=0.433
2025-01-25 13:19:41,848 - INFO - time_step=30 loss=129.831 time=0.433
2025-01-25 13:19:42,474 - INFO - time_step=40 loss=1107.434 time=0.626
2025-01-25 13:19:43,142 - INFO - time_step=50 loss=135.954 time=0.668
2025-01-25 13:19:43,812 - INFO - time_step=60 loss=99.782 time=0.670
2025-01-25 13:19:44,275 - INFO - time_step=70 loss=110.308 time=0.463
2025-01-25 13:19:44,700 - INFO - time_step=80 loss=393.167 time=0.425
2025-01-25 13:19:45,128 - INFO - time_step=90 loss=129.729 time=0.428
2025-01-25 13:19:45,798 - INFO - time_step=100 loss=125.590 time=0.670
2025-01-25 13:20:57,267 - INFO - time_step=100 avg_return=-121.966
2025-01-25 13:20:57,955 - INFO - time_step=110 loss=209.398 time=72.157
2025-01-25 13:20:58,649 - INFO - time_step=120 loss=198.797 time=0.694
2025-01-25 13:20:59,345 - INFO - time_step=130 loss=123.529 time=0.696
2025-01-25 13:20:59,878 - INFO - time_step=140 loss=125.281 time=0.533
2025-01-25 13:21:00,503 - INFO - time_step=150 loss=309.794 time=0.625
2025-01-25 13:21:01,190 - INFO - time_step=160 loss=189.271 time=0.687
2025-01-25 13:21:01,879 - INFO - time_step=170 loss=708.003 time=0.690
2025-01-25 13:21:02,499 - INFO - time_step=180 loss=128.117 time=0.620
2025-01-25 13:21:03,164 - INFO - time_step=190 loss=142.227 time=0.665
2025-01-25 13:21:03,897 - INFO - time_step=200 loss=110.155 time=0.733
2025-01-25 13:22:26,536 - INFO - time_step=200 avg_return=-172.185
2025-01-25 13:22:27,121 - INFO - time_step=210 loss=215.745 time=83.224
2025-01-25 13:22:27,697 - INFO - time_step=220 loss=132.205 time=0.576
2025-01-25 13:22:28,276 - INFO - time_step=230 loss=359.514 time=0.579
2025-01-25 13:22:28,936 - INFO - time_step=240 loss=422.041 time=0.660
2025-01-25 13:22:29,601 - INFO - time_step=250 loss=142.786 time=0.666
2025-01-25 13:22:30,240 - INFO - time_step=260 loss=135.708 time=0.638
2025-01-25 13:22:30,921 - INFO - time_step=270 loss=117.303 time=0.682
2025-01-25 13:22:31,597 - INFO - time_step=280 loss=127.502 time=0.675
2025-01-25 13:22:32,257 - INFO - time_step=290 loss=535.637 time=0.660
2025-01-25 13:22:32,938 - INFO - time_step=300 loss=179.327 time=0.681
2025-01-25 13:23:57,238 - INFO - time_step=300 avg_return=-135.465
2025-01-25 13:23:57,923 - INFO - time_step=310 loss=119.373 time=84.986
2025-01-25 13:23:58,439 - INFO - time_step=320 loss=121.193 time=0.515
2025-01-25 13:23:58,892 - INFO - time_step=330 loss=105.881 time=0.453
2025-01-25 13:23:59,394 - INFO - time_step=340 loss=395.809 time=0.502
2025-01-25 13:24:00,073 - INFO - time_step=350 loss=113.719 time=0.679
2025-01-25 13:24:00,755 - INFO - time_step=360 loss=394.406 time=0.682
2025-01-25 13:24:01,429 - INFO - time_step=370 loss=102.718 time=0.674
2025-01-25 13:24:02,104 - INFO - time_step=380 loss=123.532 time=0.675
2025-01-25 13:24:02,793 - INFO - time_step=390 loss=115.872 time=0.688
2025-01-25 13:24:03,520 - INFO - time_step=400 loss=704.288 time=0.727
2025-01-25 13:25:23,366 - INFO - time_step=400 avg_return=-168.761
2025-01-25 13:25:24,048 - INFO - time_step=410 loss=121.381 time=80.528
2025-01-25 13:25:24,735 - INFO - time_step=420 loss=723.563 time=0.686
2025-01-25 13:25:25,415 - INFO - time_step=430 loss=453.471 time=0.680
2025-01-25 13:25:26,102 - INFO - time_step=440 loss=130.190 time=0.687
2025-01-25 13:25:26,820 - INFO - time_step=450 loss=120.540 time=0.718
2025-01-25 13:25:27,516 - INFO - time_step=460 loss=116.059 time=0.696
2025-01-25 13:25:28,201 - INFO - time_step=470 loss=375.458 time=0.684
2025-01-25 13:25:28,876 - INFO - time_step=480 loss=122.731 time=0.676
2025-01-25 13:25:29,563 - INFO - time_step=490 loss=430.328 time=0.686
2025-01-25 13:25:30,255 - INFO - time_step=500 loss=524.346 time=0.692
2025-01-25 13:26:50,652 - INFO - time_step=500 avg_return=-163.386
2025-01-25 13:26:51,080 - INFO - time_step=510 loss=111.804 time=80.825
2025-01-25 13:26:51,507 - INFO - time_step=520 loss=943.766 time=0.428
2025-01-25 13:26:51,940 - INFO - time_step=530 loss=131.458 time=0.433
2025-01-25 13:26:52,372 - INFO - time_step=540 loss=166.476 time=0.432
2025-01-25 13:26:52,797 - INFO - time_step=550 loss=114.159 time=0.425
2025-01-25 13:26:53,307 - INFO - time_step=560 loss=696.432 time=0.510
2025-01-25 13:26:53,833 - INFO - time_step=570 loss=107.215 time=0.526
2025-01-25 13:26:54,512 - INFO - time_step=580 loss=110.357 time=0.679
2025-01-25 13:26:55,196 - INFO - time_step=590 loss=118.215 time=0.684
2025-01-25 13:26:55,929 - INFO - time_step=600 loss=396.431 time=0.733
2025-01-25 13:28:16,140 - INFO - time_step=600 avg_return=-205.399
2025-01-25 13:28:16,566 - INFO - time_step=610 loss=719.611 time=80.637
2025-01-25 13:28:17,003 - INFO - time_step=620 loss=128.920 time=0.437
2025-01-25 13:28:17,429 - INFO - time_step=630 loss=235.308 time=0.426
2025-01-25 13:28:17,856 - INFO - time_step=640 loss=754.623 time=0.427
2025-01-25 13:28:18,283 - INFO - time_step=650 loss=830.726 time=0.427
2025-01-25 13:28:18,708 - INFO - time_step=660 loss=199.191 time=0.426
2025-01-25 13:28:19,137 - INFO - time_step=670 loss=107.890 time=0.428
2025-01-25 13:28:19,591 - INFO - time_step=680 loss=117.360 time=0.454
2025-01-25 13:28:20,101 - INFO - time_step=690 loss=555.412 time=0.510
2025-01-25 13:28:20,532 - INFO - time_step=700 loss=107.361 time=0.431
2025-01-25 13:29:36,520 - INFO - time_step=700 avg_return=-135.763
2025-01-25 13:29:36,951 - INFO - time_step=710 loss=118.330 time=76.419
2025-01-25 13:29:37,379 - INFO - time_step=720 loss=193.437 time=0.428
2025-01-25 13:29:37,803 - INFO - time_step=730 loss=117.727 time=0.424
2025-01-25 13:29:38,232 - INFO - time_step=740 loss=141.578 time=0.428
2025-01-25 13:29:38,656 - INFO - time_step=750 loss=415.862 time=0.424
2025-01-25 13:29:39,083 - INFO - time_step=760 loss=1083.577 time=0.427
2025-01-25 13:29:39,507 - INFO - time_step=770 loss=112.769 time=0.425
2025-01-25 13:29:39,934 - INFO - time_step=780 loss=144.742 time=0.427
2025-01-25 13:29:40,361 - INFO - time_step=790 loss=111.364 time=0.427
2025-01-25 13:29:40,812 - INFO - time_step=800 loss=370.463 time=0.451
2025-01-25 13:30:58,769 - INFO - time_step=800 avg_return=-143.268
2025-01-25 13:30:59,219 - INFO - time_step=810 loss=122.982 time=78.407
2025-01-25 13:30:59,782 - INFO - time_step=820 loss=112.336 time=0.563
2025-01-25 13:31:00,462 - INFO - time_step=830 loss=127.924 time=0.680
2025-01-25 13:31:01,148 - INFO - time_step=840 loss=360.519 time=0.686
2025-01-25 13:31:01,834 - INFO - time_step=850 loss=125.845 time=0.686
2025-01-25 13:31:02,518 - INFO - time_step=860 loss=112.894 time=0.684
2025-01-25 13:31:03,207 - INFO - time_step=870 loss=111.231 time=0.689
2025-01-25 13:31:03,885 - INFO - time_step=880 loss=118.821 time=0.678
2025-01-25 13:31:04,571 - INFO - time_step=890 loss=272.330 time=0.686
2025-01-25 13:31:05,249 - INFO - time_step=900 loss=188.160 time=0.678
2025-01-25 13:32:15,713 - INFO - time_step=900 avg_return=-171.541
2025-01-25 13:32:16,108 - INFO - time_step=910 loss=115.168 time=70.858
2025-01-25 13:32:16,612 - INFO - time_step=920 loss=984.772 time=0.504
2025-01-25 13:32:17,008 - INFO - time_step=930 loss=106.573 time=0.396
2025-01-25 13:32:17,442 - INFO - time_step=940 loss=131.921 time=0.434
2025-01-25 13:32:17,842 - INFO - time_step=950 loss=128.229 time=0.400
2025-01-25 13:32:18,243 - INFO - time_step=960 loss=118.811 time=0.400
2025-01-25 13:32:18,659 - INFO - time_step=970 loss=108.742 time=0.417
2025-01-25 13:32:19,060 - INFO - time_step=980 loss=113.204 time=0.400
2025-01-25 13:32:19,457 - INFO - time_step=990 loss=861.242 time=0.398
2025-01-25 13:32:19,879 - INFO - Saved checkpoint: ./result/Pendulum-v1_SAC_wo_normalize_0125_131706/model/ckpt-1000
2025-01-25 13:32:19,879 - INFO - agent and replay_buffer saved
2025-01-25 13:32:19,879 - INFO - run() total_time=906.331
WARNING:tensorflow:Detecting that an object or model or tf.train.Checkpoint is being deleted with unrestored values. See the following logs for the specific values in question. To silence these warnings, use `status.expect_partial()`. See https://www.tensorflow.org/api_docs/python/tf/train/Checkpoint#restorefor details about the status object returned by the restore function.
2025-01-25 13:32:20,247 - WARNING - Detecting that an object or model or tf.train.Checkpoint is being deleted with unrestored values. See the following logs for the specific values in question. To silence these warnings, use `status.expect_partial()`. See https://www.tensorflow.org/api_docs/python/tf/train/Checkpoint#restorefor details about the status object returned by the restore function.
WARNING:tensorflow:Value in checkpoint could not be found in the restored object: (root).agent._log_cql_alpha
2025-01-25 13:32:20,247 - WARNING - Value in checkpoint could not be found in the restored object: (root).agent._log_cql_alpha
WARNING:tensorflow:Value in checkpoint could not be found in the restored object: (root).agent._cql_alpha_optimizer._iterations
2025-01-25 13:32:20,247 - WARNING - Value in checkpoint could not be found in the restored object: (root).agent._cql_alpha_optimizer._iterations
WARNING:tensorflow:Value in checkpoint could not be found in the restored object: (root).agent._cql_alpha_optimizer._learning_rate
2025-01-25 13:32:20,247 - WARNING - Value in checkpoint could not be found in the restored object: (root).agent._cql_alpha_optimizer._learning_rate
WARNING:tensorflow:Value in checkpoint could not be found in the restored object: (root).agent._cql_alpha_optimizer._variables.1
2025-01-25 13:32:20,247 - WARNING - Value in checkpoint could not be found in the restored object: (root).agent._cql_alpha_optimizer._variables.1
WARNING:tensorflow:Value in checkpoint could not be found in the restored object: (root).agent._cql_alpha_optimizer._variables.2
2025-01-25 13:32:20,247 - WARNING - Value in checkpoint could not be found in the restored object: (root).agent._cql_alpha_optimizer._variables.2
